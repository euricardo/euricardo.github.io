var CryptopiaPages=CryptopiaPages||{};CryptopiaPages.CoinInfo=function(){function u(t){postJson(h,{currencyId:t},function(r){$("#currencyTarget").html(Mustache.render(s,{currencyId:t,symbol:r.Symbol,name:r.Name,starRating:getStarRating(r.StarRating),ratingSummary:r.StarRating>=0?String.format(Resources.CoinInfo.InfoRatingText,r.StarRating):Resources.CoinInfo.InfoRatingUnratedText,maxRating:r.MaxRating,totalRating:r.TotalRating,statusMessage:r.StatusMessage,hasWarningBackground:r.ListingStatus==="Active"&&r.Status!=="OK",hasDangerBackground:r.ListingStatus==="Delisting",algo:r.AlgoType,network:r.NetworkType,block:r.CurrentBlock,blockTime:r.BlockTime,blockReward:r.BlockReward.toFixed(8),totalCoin:r.TotalCoin.toFixed(8),posRate:r.PosRate,minStakeAge:r.MinStakeAge||Resources.General.NotAvailable,maxStakeAge:r.MaxStakeAge||Resources.General.NotAvailable,diffRetarget:r.DiffRetarget,website:r.Website,source:r.Source,blockExplorer:r.BlockExplorer,launchForum:r.LaunchForum,cryptopiaForum:r.CryptopiaForum,totalPremine:r.TotalPremine,walletWindows:r.WalletWindows?Resources.General.Yes:Resources.General.No,walletLinux:r.WalletLinux?Resources.General.Yes:Resources.General.No,walletMac:r.WalletMac?Resources.General.Yes:Resources.General.No,walletMobile:r.WalletMobile?Resources.General.Yes:Resources.General.No,walletWeb:r.WalletWeb?Resources.General.Yes:Resources.General.No,ratingBlockEx:r.BlockExplorer?Resources.General.Yes:Resources.General.No,ratingForum:r.CryptopiaForum?Resources.General.Yes:Resources.General.No,ratingWebsite:r.Website?Resources.General.Yes:Resources.General.No,poolFee:r.PoolFee.toFixed(2),tradeFee:r.TradeFee.toFixed(2),withdrawFee:r.WithdrawFee.toFixed(8),withdrawMin:r.WithdrawMin.toFixed(8),withdrawMax:r.WithdrawMax.toFixed(8),minConfirmations:r.MinConfirmations,tippingExpires:formatToLocalDate(r.TippingExpires),tipMin:r.TipMin.toFixed(8),rewardExpires:formatToLocalDate(r.RewardsExpires)}));$(".btn-details-edit").off().on("click",function(){var n=$(this).data("id");n&&openModalGet(c,{id:n},function(t){t.Success&&(u(n),y.ajax.reload())})});$(".view-info-btn").off().on("click",function(){$(".view-info").show();$(".view-links").hide();$(".view-rating").hide();$(".view-settings").hide();n="";i()});$(".view-links-btn").off().on("click",function(){$(".view-info").hide();$(".view-links").show();$(".view-rating").hide();$(".view-settings").hide();n="links";i()});$(".view-rating-btn").off().on("click",function(){$(".view-info").hide();$(".view-links").hide();$(".view-rating").show();$(".view-settings").hide();n="rating";i()});$(".view-settings-btn").off().on("click",function(){$(".view-info").hide();$(".view-links").hide();$(".view-rating").hide();$(".view-settings").show();n="settings";i()});n=="rating"&&$(".view-rating-btn").trigger("click");n=="links"&&$(".view-links-btn").trigger("click");n=="settings"&&$(".view-settings-btn").trigger("click");i()})}function i(){var t="?coin=DOT";r!=""&&(t="?coin="+r);n!=""&&(t+="&view="+n);History.pushState({},"Cryptopia - "+Resources.CoinInfo.PageTitle,t)}function p(n){openModalGet(a,{id:n})}function w(){var n=$("#currencyInfo tr.info"),t,i,r;n.length>0&&f&&(f=!1,t=0,n.position()&&(t=n.position().top),i=n.height()*3,r=$(".dataTables_scrollBody").height(),t>r-i&&$(".dataTables_scrollBody").animate({scrollTop:t-i}))}var r,s=$("#currencyTemplate").html(),t=$(".coininfo-content"),h=t.data("action"),c=t.data("update"),n=t.data("view"),l=t.data("coin"),a=t.data("peerinfo"),f=!0,e=!0,o=$("#currencyInfo"),v=o.data("action"),y=o.DataTable({order:[[1,"asc"]],lengthChange:!1,processing:!1,bServerSide:!1,searching:!0,scrollY:"0px",scrollX:!1,paging:!1,info:!0,ajax:v,sServerMethod:"GET",language:{emptyTable:Resources.CoinInfo.InfoCurrencyListEmptyMessage},columnDefs:[{targets:0,orderable:!1,visible:!1},{targets:2,searchable:!0,orderable:!1,visible:!1},{targets:9,orderable:!1,visible:!1},{targets:1,render:function(n,t,i){return'<div style="display:inline-block"><div class="sprite-small sprite-'+i[2]+'-small-png"><\/div> '+n+" ("+i[2]+")<\/div>"}},{targets:3,searchable:!1,orderable:!0,type:"title-numeric",render:function(n){return'<span title="'+n+'"><\/span><span>'+getStarRating(n)+"<\/span>"}},{targets:6,searchable:!1,type:"title-numeric",render:function(n){return'<span title="'+n+'"><\/span><button class="btn btn-xs btn-info peer-info" style="width:110px">Connections: '+n+"<\/button>"}},{targets:8,render:function(n,t,i){return i[9]?'<span style="white-space:nowrap;cursor:pointer" class="btn-maintenance" data-message="'+i[9]+'">'+n+' <i style="height:100%;vertical-align:middle;" class="fa fa-info-circle text-info"><\/i><\/span>':n}}],fnRowCallback:function(n,t){var i=$(n);t[8]!="OK"&&i.addClass("warning");t[10]==="Delisting"&&(i.removeClass("warning"),i.addClass("danger"));i.off().on("click",function(n){$(n.target).is("button.peer-info")?p(t[0]):r!=t[2]&&($("#currencyInfo tr").removeClass("info"),$(this).addClass("info"),r=t[2],u(t[0]))});e==!0&&t[2]==l&&(e=!1,i.trigger("click"))},fnDrawCallback:function(){$(".btn-maintenance").off().on("click",function(){notify(Resources.CoinInfo.InfoWalletStatusMessageTitle,$(this).data("message")||Resources.CoinInfo.InfoWalletStatusMaintenanceMessage)});w()}});$(window).resize(function(){var n=$("#table-panel").height()-135;$(".dataTables_scrollBody").height(n)});$(window).resize()};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.DepositDisplay=function(){function n(n,t,i,r){$("#addressContent").show();$("#depositAddress").val(t);$("#depositAddress2").val(i);$("#depositAddress3").val(r);$("#copy-icon").click(function(){$("#depositAddress").select();document.execCommand("copy");$("#addressContainer").addClass("has-success");var n=$("#addressLabel").html();$("#addressLabel").html(String.format(Resources.DepositDisplay.CopiedToClipboardMessage,n))});$("#copy-icon2").click(function(){$("#depositAddress2").select();document.execCommand("copy");$("#addressContainer2").addClass("has-success");var n=$("#addressLabel2").html();$("#addressLabel2").html(String.format(Resources.DepositDisplay.CopiedToClipboardMessage,n))});$("#copy-icon3").click(function(){$("#depositAddress3").select();document.execCommand("copy");$("#addressContainer3").addClass("has-success");var n=$("#addressLabel3").html();$("#addressLabel3").html(String.format(Resources.DepositDisplay.CopiedToClipboardMessage,n))});n&&$("#qr-code").qrcode({text:n,width:250,height:250})}addressData?n(qrCodeData,addressData,addressData2,addressData3):($.blockUI({message:Resources.DepositDisplay.CreatingAddressMessage}),postJson(createAction,{currencyId:currencyId},function(t){$.unblockUI();t.Success?n(t.QrCode,t.AddressData,t.AddressData2,t.AddressData3):($("#errorMessage").show(),$("#errorText").html(t.Message))}));$("#depositAddress, #depositAddress2, #depositAddress3").click(function(){$(this).select()});$("[name=fiatDepositOptions]").click(function(){var n=$(this).val();$(".fiatDepositOptions").hide();$(".fiatDepositOption"+n).show();$("#instructions").hide();n=="Bank"&&$("#instructions").show()})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.DepositIndex=function(){function n(n){if(!n.id)return n.text;return $('<div><div style="margin-top:2px;margin-right:3px" class="sprite-small sprite-'+n.element.value+'-small-png"><\/div>'+n.text+"<\/div>")}$("#Symbol").select2({placeholder:Resources.Deposit.SelectCurrencyLabel,allowClear:!1,templateResult:n,templateSelection:n});$("#Symbol").on("change",function(){var t=displayAction+"?currency=",n=$(this).val();n&&($("#next").removeAttr("disabled"),$("#next").attr("href",t+n+(returnUrl?"&returnUrl="+returnUrl:"")))})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.TransferIndex=function(){function n(n){if(!n.id)return n.text;return $('<div><div style="margin-top:2px;margin-right:3px" class="sprite-small sprite-'+n.element.value+'-small-png"><\/div>'+n.text+"<\/div>")}$("#Symbol").select2({placeholder:Resources.Transfer.SelectCurrencyPlaceholder,allowClear:!1,templateResult:n,templateSelection:n});$("#Symbol").on("change",function(){var t=createAction+"?currency=",n=$(this).val();n&&($("#next").removeAttr("disabled"),$("#next").attr("href",t+n+(returnUrl?"&returnUrl="+returnUrl:"")))})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.TransferCreate=function(){$(".form-horizontal").on("submit",function(){var n=$(this),t=n.valid();t&&($("#submit, #cancel").attr("disabled","disabled"),$("#submit").html(String.format('<span><i class="fa fa-spinner fa-pulse fa-fw"><\/i>{0}<\/span>',Resources.General.ProcessingMessage)))});$("#Amount").on("change keyup paste",function(){var t=$(this),n=+t.val()||0;$("#netamount").html(n.toFixed(8));$("#netamount").removeClass("text-success text-danger");$("#netamount").addClass(n>0?"text-success":"")});$("#balance").on("click",function(){var n=$(this);$("#Amount").val(n.html()).trigger("change")});$("#sendtfacode").on("click",function(){$("#tfaCodeMessage").hide();$("#tfaCodeMessage").removeClass("alert-success alert-danger");$.blockUI({message:Resources.TransferCreate.SendingCodeMessage});getJson(tfaCodeAction,{componentType:21},function(n){$.unblockUI();$("#tfaCodeMessage").show();n.Success?($("#tfaCodeMessage").addClass("alert-success"),$("#tfaCodeMessage > p").html(Resources.TransferCreate.SendingCodeSuccessMessage)):($("#tfaCodeMessage").addClass("alert-danger"),$("#errorMessage > p").html(String.format(Resources.TransferCreate.SendingCodeFailureMessage,String.format('<a href="../Support">{0}<\/a>',Resources.General.CryptopiaSupportLink))))})});$("#UserName").on("keyup paste change",function(){$("#submit").attr("disabled","disabled");$("#search-container").removeClass("has-error has-success");$("#check").removeClass("btn-primary btn-danger btn-success").addClass("btn-primary").html(String.format("<span>{0}<\/span>",Resources.TransferCreate.VerifyUserButton))});$("#check").on("click",function(){$("#transfer-content").hide();$("#transfer-message").show();$("#submit").attr("disabled","disabled");var n=$("#UserName").val();$("#search-container").removeClass("has-error has-success");$("#check").removeClass("btn-primary btn-danger btn-success").addClass("btn-primary");n&&getJson("/Transfer/CheckUser/",{userName:n},function(t){t.Success?($("#submit").removeAttr("disabled"),$("#check").addClass("btn-success").html(String.format('<span><i class="fa fa-check fa-lg"><\/i>{0}<\/span>',Resources.TransferCreate.VerifyUserDoneButton)),$("#search-container").addClass("has-success"),$("#transfer-content").show(),$("#transfer-message").hide(),$("#transfer-receiver .profile-usertitle-name").html(n),$("#transfer-avatar").attr("src","/Content/Images/Avatar/"+n+".png")):($("#check").addClass("btn-danger").html(String.format('<span><i class="fa fa-times fa-lg"><\/i>{0}<\/span>',Resources.TransferCreate.VerifyUserNotFoundButton)),$("#search-container").addClass("has-error"))})});searchParam&&$("#check").trigger("click")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.TwoFactorCreate=function(){function n(){$("button").removeClass("btn-success btn-danger");$("#validationMessage").addClass("validation-summary-valid");$("#validationMessage").removeClass("validation-summary-errors");$("#errorMessage").hide();$("#successMessage").hide();$("#EmailCode, #GoogleCode, #CryptopiaCode").removeClass("has-success")}function t(n){$("#errorMessage").show();$("#successMessage").hide();$("#errorMessage > h5").text(n)}function i(n){$("#errorMessage").hide();$("#successMessage").show();$("#successMessage > h5").text(n)}$("#Type").on("change",function(){var r=$(this),t,i;n();$(".input-submit").show().removeAttr("disabled");$(".data-input-email, .data-input-authapp, .data-input-pincode, .data-input-none, .data-input-password, .data-input-question, .data-input-cryptopia").hide();t=r.val();t==="0"&&($(".data-input-none").show(),$(".input-submit").hide());t==="1"&&$(".data-input-email").show();t==="2"&&($(".data-input-authapp").show(),i=$("#existing-authapp").data("activated"),i||$(".input-submit").attr("disabled","disabled"));t==="3"&&$(".data-input-pincode").show();t==="10"&&$(".data-input-password").show();t==="11"&&$(".data-input-question").show();t==="12"&&(i=$("#existing-cryptopia").data("activated"),i||$(".input-submit").attr("disabled","disabled"),$(".data-input-cryptopia").show())}).trigger("change");$("#send-email").on("click",function(){var r,u;if(n(),r=$(this),u=$("#DataEmail").val(),u){var f=r.data("action"),e=r.data("error"),o=r.data("success"),s=r.data("component");$.blockUI({message:Resources.General.SendingMessage});postJson(f,{componentType:s,dataEmail:u},function(n){if($.unblockUI(),n.Success){$("#send-email").removeClass("btn-danger, btn-primary").addClass("btn-default");i(o);return}$("#send-email").removeClass("btn-primary, btn-default").addClass("btn-danger");t(e)})}});$("#verify-authapp").on("click",function(){var r,u;if(n(),r=$(this),u=$("#AuthAppCode").val(),u){var f=r.data("action"),e=r.data("error"),o=r.data("success"),s=r.data("key");postJson(f,{key:s,code:u},function(n){if(n.Success){$("#verify-authapp").removeClass("btn-danger").addClass("btn-success");$(".input-submit").removeAttr("disabled");i(o);return}$("#verify-authapp").removeClass("btn-success").addClass("btn-danger");t(e)})}$(".input-submit").prop("disabled",!0)});$("#activate-Cryptopia").on("click",function(){var f;n();var e=$(this),r=$("#CryptopiaCode").val(),u=$("#CryptopiaSerial").val();r&&u&&(f=e.data("action"),postJson(f,{serialNumber:u,code:r},function(n){if(n.Success){$("#activate-Cryptopia").removeClass("btn-info").addClass("btn-success").html("Activated").attr("disabled","disabled");$(".data-input-cryptopia").attr("readonly","readonly");$(".input-submit").removeAttr("disabled");i(n.Message);return}t(n.Message)}))});$(".preview-popover").popover({trigger:"hover",container:"body"})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserIndex=function(){function t(t){var r=$('#tabcontrol a[data-section="'+t+'"]'),i;if(r){n&&(i=$(n),i&&(i.removeClass("user-tabtarget"),i.off(),i.unbind(),i.empty()));var u=r.data("div"),e=r.data("action"),f=r.data("section");getPartial(u,e,!1);n=u;History.pushState({},"Cryptopia - "+f,f)}}var n;$('a[data-toggle="tab"]').on("shown.bs.tab",function(){var n=$(this).data("section");n&&t(n)});$('#tabcontrol a[data-section="'+$("#tabcontrol").data("default")+'"]').trigger("click")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserBalance=function(){var n;$("#search-box").keyup(function(){n.search($(this).val()).draw()});$(".currency-dustbin").on("click",function(){var n=$(this),i=n.data("action"),t=n.data("currency"),r=n.data("symbol");t&&confirm(Resources.UserBalances.BalancesDustQuestionTitle,String.format(Resources.UserBalances.BalancesDustQuestion,r),function(){postJson(i,{currencyId:t},function(n){showMessage(n);n&&n.Success&&$(".balancedata-"+t).html("0.00000000")})})});$("#chk-hidezero").click(function(){var t=$(this),i=t.data("action"),r=t.is(":checked");postJson(i,{hide:r});n.draw()});$("#chk-favorites").click(function(){var t=$(this),i=t.data("action"),r=t.is(":checked");postJson(i,{show:r});n.draw()});$(".chk-setfavorite").click(function(){var t=$(this),r=t.data("action"),i=t.is(":checked"),u=t.data("currency");postJson(r,{currencyId:u});n.cell($(this).closest("tr"),7).data(i);i||n.draw()});$.fn.dataTable.ext.search.push(function(n,t){var i=!0,r=$("#chk-hidezero").is(":checked"),u=$("#chk-favorites").is(":checked");return u&&(i=t[7]==="true"),r&&i&&(i=t[3]>0),i});n=$("#table-balances").DataTable({sDom:"lrtip",order:[],lengthChange:!1,processing:!1,bServerSide:!1,searching:!0,scrollCollapse:!1,sort:!0,pageLength:15,paging:!0,info:!1,language:{emptyTable:Resources.UserBalances.BalancesEmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:0,searchable:!1,orderable:!1},{targets:1,searchable:!0,orderable:!0},{targets:2,searchable:!1,orderable:!0},{targets:3,searchable:!0,orderable:!0},{targets:4,searchable:!1,orderable:!0},{targets:5,searchable:!1,orderable:!0},{targets:6,searchable:!1,orderable:!1},{targets:7,visible:!1,searchable:!0,orderable:!1}],fnDrawCallback:function(){$(".preview-popover").popover({trigger:"hover"})}});$("#balanceTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserDeposit=function(){var n=$("#deposits"),t=n.data("action");n.DataTable({dom:datatableExportLayout,buttons:datatableExportButtons("Deposit History"),lengthChange:!0,lengthMenu:[[15,50,500,5e3,25e3],[15,50,500,5e3,25e3]],order:[[0,"desc"]],searchDelay:800,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:t,sServerMethod:"POST",language:{emptyTable:Resources.UserDepositHistory.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:1,render:function(n){return'<div style="display:inline-block"><div class="sprite-small sprite-'+n+'-small-png"><\/div> '+n+"<\/div>"}},{targets:7,searchable:!0,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}]});$("#depositsTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserTradeHistory=function(){var t,n=$("#tradehistory"),i=n.data("action");t=n.DataTable({dom:datatableExportLayout,buttons:datatableExportButtons("Trade History"),lengthChange:!0,lengthMenu:[[15,50,500,5e3,25e3],[15,50,500,5e3,25e3]],order:[[0,"desc"]],searchDelay:800,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:i,sServerMethod:"POST",language:{emptyTable:Resources.TradeHistory.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:1,searchable:!0,orderable:!0,render:function(n){return'<a href="/Exchange?market='+n.replace("/","_")+'">'+n+"<\/a>"}},{targets:5,render:function(n,t,i){return new Decimal(i[3]).mul(i[4]).toFixed(8)}},{targets:6,render:function(n,t,i){return i[5]}},{targets:7,searchable:!0,orderable:!0,render:function(n,t,i){return formatToLocalDateTime(i[6])}}],fnDrawCallback:function(){}});$("#tradeHistoryTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserTrades=function(){var n,t=$("#trades"),i=t.data("action"),r=t.data("action-exchange");n=t.DataTable({order:[[0,"desc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:i,sServerMethod:"POST",language:Resources.UserTrades.DataTablesLanguage,columnDefs:[{targets:1,visible:!1},{targets:2,searchable:!0,orderable:!0,render:function(n){return'<a href="'+r+"?market="+n.replace("/","_")+'">'+n+"<\/a>"}},{targets:9,searchable:!0,orderable:!0,render:function(n){return formatToLocalDateTime(n)}},{targets:10,searchable:!1,orderable:!1,render:function(){return'<div><i class="trade-item-remove fa fa-times cancel-button"><\/i><\/div>'}}],fnRowCallback:function(t,i){var r=$(t);r.on("click",function(t){var r=$(t.target);r.is("i.cancel-button")&&cancelOrder(i[0],i[1],function(){n.ajax.reload()})})}});$("#tradesTarget").addClass("user-tabtarget");$("#trades-cancel-all").on("click",function(){cancelAllOrders(function(){n.ajax.reload()})})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserKarma=function(){var t=$("#karmaHistory"),r=t.data("action"),n,i;t.DataTable({order:[[0,"desc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:r,sServerMethod:"POST",language:{emptyTable:Resources.UserKarma.HistoryEmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:1,searchable:!1,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}]});n=$("#karmaReceived");i=n.data("action");n.DataTable({order:[[0,"desc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:i,sServerMethod:"POST",language:{emptyTable:Resources.UserKarma.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:0,searchable:!1,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}]});$("#karmaTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserNotification=function(){$(".messageitem").on("click",function(){$(".messageitem").removeClass("active");$(this).addClass("active")});$("#notify-dismiss").on("click",function(){var n=$(this).data("action");n&&getJson(n,{},function(){$(".unread-notification-count").html("")})});$("#notify-deleteall").on("click",function(){var n=$(this).data("action");$.blockUI({message:Resources.UserNotifications.NotificationsDeletingMessage});n&&getJson(n,{},function(){$.unblockUI();$(".notification-unreadcount").html("");$("#notification-list").html('<div class="text-center"><i>'+Resources.UserNotifications.NotificationsEmptyListInfoText+"<\/i><\/div>");$(".unread-notification-count").html("")})});$(window).off().resize(function(){var n=$(".profile-sidebar").height()-($(".notification-toolbar").outerHeight()+$(".settings-page-header-container").outerHeight());$("#notification-container").height(n)});$(window).resize();$("#notificationTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserPaytopia=function(){function r(n){openModalGet(i,{id:n},function(n){showMessage(n)})}var n=$("#payments"),t=n.data("action"),i=n.data("action-get"),u=n.DataTable({order:[[0,"desc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:t,sServerMethod:"POST",language:{emptyTable:Resources.UserPaytopia.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:[5,6],visible:!1,searchable:!1,orderable:!1},{targets:[7,8,11],render:function(n){return formatToLocalDate(n)}},{targets:[9],render:function(n,t,i){return i[4]=="Pending"?String.format("<i>{0}<\/i>",Resources.UserPaytopia.TransferIdPendingValue):n==0?String.format("<i class='text-danger'>{0}<\/i>",Resources.UserPaytopia.TransferIdErrorValue):n}},{targets:[10],render:function(n,t,i){return i[4]=="Refunded"&&n>0?n:i[4]=="Refunded"&&n==0?String.format("<i class='text-danger'>{0}<\/i>",Resources.UserPaytopia.RefundIdErrorValue):String.format("<i>{0}<\/i>",Resources.General.NotAvailable)}},{targets:[12],searchable:!1,orderable:!1,render:function(){return'<button class="btn btn-default btn-xs pull-right payment-btn" style="width:100px">'+Resources.UserPaytopia.InfoButton+"<\/button>"}}],fnRowCallback:function(n,t){var i=$(n);i.on("click",function(n){var i=$(n.target);i.is("button.payment-btn")&&r(t[0])})},fnDrawCallback:function(){}});$("#paytopiaTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserReferral=function(){var n=$("#referrals"),t=n.data("action");n.DataTable({order:[[0,"desc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:t,sServerMethod:"POST",language:{emptyTable:Resources.UserReferral.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:6,searchable:!0,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}]});$("#referralHistoryTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserSecurity=function(){$("#DisableConfirmation, #AddressBookOnly").on("click",function(){var n=$("#withdrawSettings-container").data("action"),t=$("#AddressBookOnly").is(":checked"),i=$("#DisableConfirmation").is(":checked");postJson(n,{addressBookOnly:t,disableConfirmation:i},function(n){showMessage(n)})});$("#securityTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserAddressBook=function(){function r(t){if(t){var i=$("#addressBook").data("delete");confirm(Resources.UserAddressBook.SecurityAddressBookDeleteQuestionTitle,Resources.UserAddressBook.SecurityAddressBookDeleteQuestion,function(){postJson(i,{AddressBookId:t},function(){n.ajax.reload()})})}}var n,t=$("#addressBook"),i=t.data("action");n=t.DataTable({order:[[0,"asc"]],searchDelay:800,lengthChange:!1,processing:!1,bServerSide:!0,searching:!1,scrollCollapse:!0,scrollY:"250px",paging:!1,info:!1,iDisplayLength:15,sAjaxSource:i,sServerMethod:"GET",language:{emptyTable:Resources.UserAddressBook.SecurityAddressBookEmptyListMessage},columnDefs:[{targets:0,visible:!1},{targets:1,visible:!1},{targets:4,searchable:!1,orderable:!1,render:function(n,t,i){var r=n,u=n.split(":");return u.length==2&&(r=u[0]+", "+i[5]+": "+u[1]),'<span title="'+r+'">'+r+"<\/span>"}},{targets:5,visible:!1},{targets:6,searchable:!1,orderable:!1,render:function(){return'<i title="'+Resources.UserAddressBook.SecurityAddressBookDeleteHint+'" class="fa fa-times text-danger delete-btn" style="cursor:pointer;font-size:16px"><\/i>'}}],fnRowCallback:function(n,t){var i=$(n);i.on("click",function(n){var i=$(n.target);i.is("i.delete-btn")&&r(t[0])})}});$("#addAddressBook").on("click",function(){var t=$(this).data("action");openModalGet(t,null,function(){n.ajax.reload()})})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserApiSettings=function(){$("#generateKey").on("click",function(){$.unblockUI();var n=$(this).data("action");postJson(n,{},function(n){n.Success?($("#ApiKey").val(n.Key),$("#ApiSecret").val(n.Secret)):($("#apialert").show(),$("#apialert > p").html(Resources.SecurityApi.SecurityApiGenerationFailedLinkMessage),$("#apialert").fadeTo(8e3,500).slideUp(500,function(){$("#apialert").hide()}))})})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserSettings=function(){$("#Theme").on("change",function(){changeTheme($("#Theme option:selected").val())});$("#IgnoreChats").on("change",function(){$("#ignore-chat").val($(this).find("option:selected").text())});$("#IgnoreTips").on("change",function(){$("#ignore-tip").val($(this).find("option:selected").text())});$("#ignore-chat-btn").on("click",function(){var n,t;$("#tipErroralert, #chatErroralert, #tipSuccessalert, #chatSuccessalert").hide();n=$("#ignore-chat").val();n&&(t=$(this).data("action"),getJson(t,{username:n},function(t){t.Success?($("#chatSuccessalert > p").html(t.Message),$("#chatSuccessalert").fadeTo(8e3,500).slideUp(500,function(){$("#chatSuccessalert").hide()}),t.WasRemoved?$("#IgnoreChats option").filter(function(){return $(this).html()==n}).remove():$("#IgnoreChats").append('<option value="'+n+'">'+n+"<\/option>")):($("#chatErroralert > p").html(t.Message),$("#chatErroralert").fadeTo(8e3,500).slideUp(500,function(){$("#chatErroralert").hide()}))}))});$("#ignore-tip-btn").on("click",function(){var n,t;$("#tipErroralert, #chatErroralert, #tipSuccessalert, #chatSuccessalert").hide();n=$("#ignore-tip").val();n&&(t=$(this).data("action"),getJson(t,{username:n},function(t){t.Success?($("#tipSuccessalert > p").html(t.Message),$("#tipSuccessalert").fadeTo(8e3,500).slideUp(500,function(){$("#tipSuccessalert").hide()}),t.WasRemoved?$("#IgnoreTips option").filter(function(){return $(this).html()==n}).remove():$("#IgnoreTips").append('<option value="'+n+'">'+n+"<\/option>")):($("#tipErroralert > p").html(t.Message),$("#tipErroralert").fadeTo(8e3,500).slideUp(500,function(){$("#tipErroralert").hide()}))}))});$("#settingsTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserTransfer=function(){var n=$("#transfers"),t=n.data("action");n.DataTable({dom:datatableExportLayout,buttons:datatableExportButtons("Transfer History"),lengthChange:!0,lengthMenu:[[15,50,500,5e3,25e3],[15,50,500,5e3,25e3]],order:[[0,"desc"]],searchDelay:800,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:t,sServerMethod:"POST",language:{emptyTable:Resources.UserTransfer.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:1,render:function(n){return'<div style="display:inline-block"><div class="sprite-small sprite-'+n+'-small-png"><\/div> '+n+"<\/div>"}},{targets:7,searchable:!0,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}]});$("#transfersTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.UserWithdraw=function(){function f(n){confirm(Resources.UserWithdraw.ResendEmailQuestionTitle,Resources.UserWithdraw.ResendEmailQuestion,function(){$.blockUI({message:Resources.UserWithdraw.ResendingEmailMessage});getJson(r,{withdrawId:n},function(n){$.unblockUI();n.IsError&&notify(Resources.UserWithdraw.ResendEmailErrorMessageTitle,n.Message);notify(Resources.UserWithdraw.ResendEmailSuccessMessageTitle,n.Message)})})}function e(n){confirm(Resources.UserWithdraw.CancelQuestionTitle,Resources.UserWithdraw.CancelQuestion,function(){$.blockUI({message:Resources.UserWithdraw.CancelingMessage});getJson(u,{withdrawId:n},function(n){$.unblockUI();n.Success?(t.ajax.reload(),notify(Resources.UserWithdraw.CancelSuccessMessageTitle,n.Message)):notify(Resources.UserWithdraw.CancelErrorMessageTitle,n.Message)})})}var t,n=$("#withdrawals"),i=n.data("action"),r=n.data("action-resend"),u=n.data("action-cancel");t=n.DataTable({dom:datatableExportLayout,buttons:datatableExportButtons("Withdraw History"),lengthChange:!0,lengthMenu:[[15,50,500,5e3,25e3],[15,50,500,5e3,25e3]],order:[[0,"desc"]],searchDelay:800,processing:!1,bServerSide:!0,searching:!0,scrollCollapse:!0,scrollX:"100%",paging:!0,info:!0,iDisplayLength:15,sAjaxSource:i,sServerMethod:"POST",language:{emptyTable:Resources.UserWithdraw.EmptyListMessage,paginate:{next:Resources.General.Next,previous:Resources.General.Previous}},columnDefs:[{targets:1,render:function(n){return'<div style="display:inline-block"><div class="sprite-small sprite-'+n+'-small-png"><\/div> '+n+"<\/div>"}},{targets:5,searchable:!1,orderable:!1,render:function(n,t,i){return!n&&i[4]==="Unconfirmed"?'<div style="max-width:300px" class="btn-group btn-group-xs btn-group-justified nopad" ><a class="btn btn-xs btn-default resend-btn">'+Resources.UserWithdraw.ResendEmailButton+'<\/a><a class="btn btn-xs btn-danger cancel-btn">'+Resources.General.Cancel+"<\/a><\/div>":'<div style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;max-width:300px">'+n+"<\/div>"}},{targets:6,render:function(n){return'<div style="text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;max-width:200px">'+n+"<\/div>"}},{targets:7,searchable:!0,orderable:!0,render:function(n){return formatToLocalDateTime(n)}}],fnRowCallback:function(n,t){var i=$(n);i.on("click",function(n){var i=$(n.target);i.is("a.resend-btn")?(n.preventDefault(),f(t[0])):i.is("a.cancel-btn")&&(n.preventDefault(),e(t[0]))})}});$("#withdrawsTarget").addClass("user-tabtarget")};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.WithdrawCreate=function(){$("#AddressBook").on("change",function(){var t=$(this).val(),n;t||$("#AddressData, #AddressData2, #AddressDataReadonly, #AddressDataReadonly2").val(null);n=t.split(":");$("#AddressData, #AddressDataReadonly").val(n[0]);n.length==2&&$("#AddressData2, #AddressDataReadonly2").val(n[1])});$("#AddressData, #AddressData2").on("keyup cut paste",function(){$("#AddressBook").val(null)});$(".form-horizontal").on("submit",function(){var n=$(this),t=n.valid();t&&($("#submit, #cancel").attr("disabled","disabled"),$("#submit").html(String.format('<span><i class="fa fa-spinner fa-pulse fa-fw"><\/i> {0}<\/span>',Resources.General.ProcessingMessage)))});$("#Amount").on("change keyup paste",function(){var r=$(this),n=0,t=+fees,i=+r.val()||0;feeType=="Percent"?(t=i-i/100*fees,n=i-t):n=i-fees;$("#feeamount").html(t.toFixed(decimals));$("#netamount").html(n.toFixed(decimals));$("#netamount").removeClass("text-success text-danger");$("#netamount").addClass(n>t?"text-success":"text-danger")});$("#Amount").on("change",function(){var n=$(this);n.val((+n.val()).toFixed(decimals))});$("#balance").on("click",function(){var n=$(this);$("#Amount").val(n.html()).trigger("change")});$("[name=fiatOptions]").click(function(){var n=$(this).val();$(".fiatOptions").hide();$(".fiatOption"+n).show();n=="Bank"?$("#AddressData").mask("99-9999-9999999-99?9"):$("#AddressData").unmask()});$("#fiatOptionBank").trigger("click");$("#sendtfacode").on("click",function(){$("#tfaCodeMessage").hide();$("#tfaCodeMessage").removeClass("alert-success alert-danger");$.blockUI({message:Resources.WithdrawCreate.SendingCodeMessage});getJson(tfaCodeAction,{componentType:20},function(n){$.unblockUI();$("#tfaCodeMessage").show();n.Success?($("#tfaCodeMessage").addClass("alert-success"),$("#tfaCodeMessage > p").html(Resources.WithdrawCreate.SendingCodeSuccessMessage)):($("#tfaCodeMessage").addClass("alert-danger"),$("#errorMessage > p").html(String.format(Resources.WithdrawCreate.withdrawCreateSendingCodeFailureMessage,String.Format('<a href="../Support">{0}<\/a>',Resources.General.CryptopiaSupportLink))))})})};CryptopiaPages=CryptopiaPages||{};CryptopiaPages.WithdrawIndex=function(){function n(n){if(!n.id)return n.text;return $('<div><div style="margin-top:2px;margin-right:3px" class="sprite-small sprite-'+n.element.value+'-small-png"><\/div>'+n.text+"<\/div>")}$("#Symbol").select2({placeholder:Resources.Withdraw.SelectCurrencyPlaceholder,allowClear:!1,templateResult:n,templateSelection:n});$("#Symbol").on("change",function(){var t=createAction+"?currency=",n=$(this).val();n&&($("#next").removeAttr("disabled"),$("#next").attr("href",t+n+(returnUrl?"&returnUrl="+returnUrl:"")))})}